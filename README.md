# Arbitrary File-Read CVE-2024-24919
Here is the alert received on the SIEM
![image](https://github.com/user-attachments/assets/c09b95aa-d999-42af-9415-ad9ecb22cce4)

Firstly what is CVE-2024-24919? Here is the description on the NIST website.
![image](https://github.com/user-attachments/assets/5925f344-a40c-4fd1-a434-24305442d0c6)

After some more research, CVE-2024-24919 is a path traversal attack, which explains the request being made to the '/etc/passwd' directory.
![image](https://github.com/user-attachments/assets/7ab71d35-fd1e-4429-bd7d-3ee41cd56549)
The /etc/passwd directory stores user account information, including the user's username, user ID (UID), group ID (GID), home directory, and login shell 

This is enough for me to contain the server, and I'll investigate further for any more signs of compromise.
![image](https://github.com/user-attachments/assets/6e8a6008-de71-4dbb-885d-242b9c80ef82)

#
<h3>Investigating the suspisous IP</h3>

First I'll start by checking the source IP on the threat intelligence feed. And it has been flagged as malicious, specifically because of CVE-2024-24919
![image](https://github.com/user-attachments/assets/d026242a-4e49-483a-8358-8c9d3b7f6449)

It has also been reported on AbuseIPDB and VirusTotal
![image](https://github.com/user-attachments/assets/307c4c8c-cdb5-46cf-a2be-905ac1a73485)
![image](https://github.com/user-attachments/assets/6d4a2548-2642-4759-8e86-f080782a8945)

Searching the logs for the source IP shows three events.
![image](https://github.com/user-attachments/assets/b13e0cb2-5ddc-4c81-8e39-b690aee0d6fe)
The two other events correlate with what was in the SIEM alert

Investigating the first log (No Event Time) it says the source address is 203.160.68.12 (the suspicious IP).
![image](https://github.com/user-attachments/assets/cddb1cfb-a10d-438c-9c5a-82df0134141e)

However, the raw log says that the IP is 203.160.68.13, and this time it's requesting the '/etc/shadow' directory. This directory stores the encrypted password hashes for user accounts on the system. Also searching the logs for 203.160.68.13 shows no results, and it's not flagged in the threat intel feed or on AbuseIPDB/Talos/VirusTotal.

![image](https://github.com/user-attachments/assets/45915f8b-02df-4887-906a-1abdb0797a9d)

#
<h3>Investigating 203.160.68.13 further</h3>

Checking the logs for the destination IP (172.16.20.146) shows the same logs seen above, and another containing a list of IPs that accessed the server. Here we see 203.160.68.12 did make three separate connections and 203.160.68.13 made only one.

![image](https://github.com/user-attachments/assets/5fce2e66-be09-412a-84f2-b79b1942d238)

The destination address (172.16.20.146) is a server and it made three connections with the suspicious IP and two with 203.160.68.13
![image](https://github.com/user-attachments/assets/950c4829-3337-449c-9c74-cac6702d0975)
![image](https://github.com/user-attachments/assets/d67ffc11-5453-44af-84b7-966679424dd7)

#
<h3>Response</h3>
The server (172.16.20.146) has been quarantined and I've blacklisted the two suspicious IPs: 203.160.68.12 and 203.160.68.13. All the impacted users should change their passwords as a precaution.

#

<h3>Summary</h3>
The attackers conducted a path traversal attack, accessing the data within the /etc/passwd and /etc/shadow directories. These files hold user information, including usernames, user IDs, and hashed passwords. If the attackers figure out the hash algorithm used they could figure out the passwords. The server was contained and the suspicious IPs were blacklisted, and all the impacted users should change their passwords as a precaution.

#
